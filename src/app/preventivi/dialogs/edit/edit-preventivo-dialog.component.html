<div class="container">
  <h3 mat-dialog-title>Preventivo: {{preventivo.nome}}</h3>

  <form class="mat-dialog-content" [formGroup]="preventivoForm">

    <div class="form">
      <mat-form-field color="accent">
        <input type="text" placeholder="Nome" maxlength="300" matInput formControlName="nome" required/>
        <div *ngIf="preventivoFormControls.nome.errors" class="invalid-feedback">
          <div *ngIf="preventivoFormControls.nome.errors.required">Il nome è obbligatorio</div>
          <div *ngIf="preventivoFormControls.nome.errors.minLength">Il nome deve avere almeno 4 caratteri</div>
        </div>
      </mat-form-field>
    </div>

    <div class="form">
      <mat-form-field color="accent">
        <input disabled matInput placeholder="Seleziona la data di emissione" formControlName="dataEmissione" [matDatepicker]="dataEmissione" required>
        <div *ngIf="preventivoFormControls.dataEmissione.errors" class="invalid-feedback">
          <div *ngIf="preventivoFormControls.dataEmissione.errors.required">La data di emissione è obbligatoria</div>
        </div>
        <mat-datepicker-toggle matSuffix [for]="dataEmissione"></mat-datepicker-toggle>
        <mat-datepicker disabled="false" #dataEmissione></mat-datepicker>
      </mat-form-field>
    </div>

    <div class="form">
      <mat-form-field color="accent">
        <textarea placeholder="Descrizione" rows="3" maxlength="300" matInput formControlName="descrizione"></textarea>
      </mat-form-field>
    </div>

    <div class="form">
      <mat-form-field color="accent">
        <input type="text" placeholder="Emettitore" maxlength="300" matInput formControlName="emettitore"/>
      </mat-form-field>
    </div>

    <div class="form">
      <mat-form-field color="accent">
        <mat-select placeholder="Tipologia" matInput formControlName="tipologia" required>
          <mat-option value="">Seleziona</mat-option>
          <mat-option *ngFor="let tipologia of tipologie" [value]="tipologia._id">
            {{tipologia.nome}}
          </mat-option>
        </mat-select>
        <div *ngIf="preventivoFormControls.tipologia.errors" class="invalid-feedback">
          <div *ngIf="preventivoFormControls.tipologia.errors.required">La tipologia è obbligatoria</div>
        </div>
      </mat-form-field>
    </div>

    <div class="form">
      <mat-form-field color="accent">
        <input type="number" placeholder="Importo" maxlength="300" matInput formControlName="importo" required/>
        <div *ngIf="preventivoFormControls.importo.errors" class="invalid-feedback">
          <div *ngIf="preventivoFormControls.importo.errors.required">L'importo è obbligatorio</div>
          <div *ngIf="preventivoFormControls.importo.errors.min">L'importo deve essere maggiore di 0</div>
        </div>
      </mat-form-field>
    </div>

    <div class="form">
      <mat-form-field color="accent">
        <mat-select placeholder="Iva" matInput formControlName="iva" required>
          <mat-option value="">Seleziona</mat-option>
          <mat-option *ngFor="let iva of valoriIva" [value]="iva._id">
            {{iva.nome}}
          </mat-option>
        </mat-select>
        <div *ngIf="preventivoFormControls.iva.errors" class="invalid-feedback">
          <div *ngIf="preventivoFormControls.iva.errors.required">L'iva è obbligatoria</div>
        </div>
      </mat-form-field>
    </div>

    <div mat-dialog-actions>
      <button mat-button [disabled]="!preventivoForm.valid" [mat-dialog-close]="1" (click)="save()">Salva</button>
      <button mat-button (click)="cancel()" tabindex="-1">Annulla</button>
    </div>
  </form>
</div>